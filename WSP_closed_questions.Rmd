---
title: "WSP closed question analysis"
author: "Lizzie Jones^[University of Brighton, l.jones4@brighton.ac.uk]"
date: "10/05/2021"
output:
  html_document:
    number_sections: no
  pdf_document:
    number_sections: no
  word_document: default
---


## WSP - Analysis, stats and visualisations for closed questions


This rMarkdown explores and analyses the closed-ended questions

### About rMarkdowns

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>. To generate the document of all content, click the **Knit** button. 

This rMarkdown document will be periodically updated and uploaded to the OneDrive folder and pushed to the WSP GitHub code repository. The primary format of this document is HTML, but this can be easily changed by changing the output (e.g. PDF, GitHub) using the 'output' section at the top of the document. The possible output formats are listed here: https://rmarkdown.rstudio.com/lesson-9.html.


```{r setup/packages, warning = FALSE, messages = FALSE, include=FALSE}
# This code assumes that all packages are installed. If not, use 'install.packages' e.g. install.packages("likert")
library(dplyr, warn.conflicts = FALSE)
# Suppress summarise info
options(dplyr.summarise.inform = FALSE)

# Key packages for data wrangling
wrangling <- c("tidyverse","purr","magrittr","lubridate","hms",
             "data.table","plyr","tidyr","tibble","reshape2")
lapply(wrangling, require, character.only = TRUE) 

# Useful survey analysis packages
survey <- c("likert","careless", "cowplot", "sjPlot","ggplot2","plotly",
            "RColorBrewer")
lapply(survey, require, character.only = TRUE) 

# Useful packages for statistics
stats <- c("stats","ggpubr","lme4","MASS","car","psych",
                   "MuMIn","glmmTMB","nlme","DHARMa")
lapply(stats, require, character.only = TRUE) 

# # Favourite data visualisation packages
# vismap <- c("ggvis","htmlwidgets","maps", "lattice","ggmap","rnaturalearth",
#              "ggrepel", "rgdal", "maptools", "gpclib")
# lapply(vismap, require, character.only = TRUE) 
# gpclibPermit()  # Gives maptool permission to use gpclib

```

```{r setwd and dataframes, include=FALSE}
# Load in working  directory and datasets
setwd("~/Documents/White-Stork-Project")
# Load in the data
original_data <- read.csv("Stork_MainDataset.csv", header = TRUE, stringsAsFactors=TRUE)
all_data <- read.csv("Stork_Dataset_Radapted.csv", header = TRUE, stringsAsFactors=TRUE)

# Load in cleaned dataset
final_data <- read.csv("WSP_R_cleaned_dataset_Final.csv", header = TRUE, stringsAsFactors=TRUE)
# View cleaned dataset
nrow(final_data)

# Define ReleaseSite and SiteProximity columns
summary(final_data$ReleaseSite)
final_data <- final_data %>% 
            mutate(SiteProximity = if_else(ReleaseSite == "No", 'No', 'Yes'))
final_data <- final_data %>% 
          sjmisc::move_columns(SiteProximity, .after = "ReleaseSite")
summary(final_data$SiteProximity)

### Create two dataframes: one for each data collection (Proactive survey and Nationally representative survey) for easier comparison
proact_data <- final_data[which(final_data$SurveyType == "Proactive"),]
natrep_data <- final_data[which(final_data$SurveyType == "NatRep"),]


```

```{r column groups, include=FALSE}

### Grouping columns
# Grouping Likert scale question columns by selecting Question numbers (and dropping scores or open questions)
overall_score_colnames <- dplyr::select(final_data, ends_with("overallscore"))

Q4_knowledge_colnames <- dplyr::select(final_data, starts_with("Q4"),
                                       -ends_with('score'))
Q5_diet_colnames <- dplyr::select(final_data, starts_with("Q5"))
Q6_habitat_colnames <- dplyr::select(final_data, starts_with("Q6"))
Q7_nesting_colnames <- dplyr::select(final_data, ends_with("nesting"))
Q8_seen_colnames <- dplyr::select(final_data, starts_with("Q8_"))

```


## Sectioned analysis (in order found in questionnaire)

### Respondent knowledge

Respondent knowledge questions have yes/no/notsure or incorrect/correct answer formats, lending themselves to Likert or Stacked bar plot style plots. Below I have created some initial plots, seperated according to sample type and started calculating sample sizes per question to create a tableto display the sample sizes per column, per survey type.

Some useful Likert plotting guides and packages:
* https://cran.r-project.org/web/packages/sjPlot/vignettes/plot_likert_scales.html
* https://towardsdatascience.com/how-to-plot-likert-scales-with-a-weighted-survey-in-a-dplyr-friendly-way-68df600881a 
* https://www.r-graph-gallery.com/202-barplot-for-likert-type-items.html



### Q2) Which of the following animals is a white stork?

```{r Q2 photo recog, echo=TRUE, messages=FALSE, warning = FALSE}

### Calculating sample sizes for knowledge questions table

# Selecting image of WS
final_data %>%
  dplyr::select(SurveyType, Q2_photo_recog_score, Q2_photo_recog) %>% 
  dplyr::group_by(SurveyType, Q2_photo_recog) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 

```

### Q3) Is the white stork native to England? 

```{r Q3 Knowledge questions, echo=FALSE, messages=FALSE}

###  Q3. Are WS native?
final_data$Q3_is_native = as.factor(final_data$Q3_is_native)

# Sample sizes:
final_data %>%
  dplyr::select(SurveyType, Q3_is_native) %>% 
  dplyr::group_by(SurveyType, Q3_is_native) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 


```


### Q4) Are the following statements true or false? 

1. Most European white storks migrate south to Africa in the winter 
2. A white stork’s wingspan can exceed 2 meters (6 feet 7 inches)
3. White storks are globally rare 

```{r Q4 Knowledge questions, echo=FALSE, messages=FALSE}

knowl_cols <- c("Q4.1_migrate_score", "Q4.2_wingspan_score", "Q4.3_globallyrare_score")
### White stork knowledge
final_data <- final_data %<>% mutate_at(knowl_cols, funs(factor(.)))
# # Select the columns and convert to Likert data using the 'Likert' package
# Q4_knowledge_scores <- final_data[knowl_cols]
# Q4_knowledge_results = likert(Q4_knowledge_scores)
# # summary(Q4_knowledge_results)
# plot(Q4_knowledge_results, type="bar")

# Migrate (yes/no)
final_data %>%
  dplyr::select(SurveyType, Q4.1_migrate_score, Q4.1_migrate) %>% 
  dplyr::group_by(SurveyType, Q4.1_migrate) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 

# Wingspan (yes/no)
final_data %>%
  dplyr::select(SurveyType, Q4.2_wingspan_score, Q4.2_wingspan) %>% 
  dplyr::group_by(SurveyType, Q4.2_wingspan) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 

# Globally rare (yes/no)
final_data %>%
  dplyr::select(SurveyType, Q4.3_globallyrare_score, Q4.3_globallyrare) %>% 
  dplyr::group_by(SurveyType, Q4.3_globallyrare) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 

```



### Q5) What do white storks typically eat? 

[multi-select] Amphibians; Fish; Invertebrates; Reptiles; Small mammals; Bird eggs/chicks; Carrion; Food waste; Vegetation; Seeds; Fruit; Don’t know 



```{r Q5 diet questions, echo=FALSE, messages=FALSE}

# Create list of diet columns names for easier factorsation and labelling
diet_col_names <- c("Q5a_amphibians_diet","Q5b_birdeggs.chicks_diet","Q5c_carrion_diet","Q5d_fish_diet",
              "Q5e_foodwaste_diet","Q5f_fruit_diet","Q5g_inverts_diet","Q5h_reptiles_diet","Q5i_seeds_diet",
              "Q5j_smallmammals_diet","Q5k_vegetation_diet", "Q5l_Don.tKnow_diet")

# Use mutate_at to set: if "don't know" = 1 then all other columns must = 0
# Then transform 0 and 1 to incorrect and correct
library(dplyr)
final_data <- final_data %>% 
  mutate_at(.vars = c("Q5a_amphibians_diet","Q5b_birdeggs.chicks_diet","Q5c_carrion_diet","Q5d_fish_diet",
              "Q5e_foodwaste_diet","Q5f_fruit_diet","Q5g_inverts_diet","Q5h_reptiles_diet","Q5i_seeds_diet",
              "Q5j_smallmammals_diet","Q5k_vegetation_diet"), ~ ifelse(Q5l_Don.tKnow_diet == 1, 0, .)) %>% 
  mutate_at(diet_col_names, funs(factor(.,
            levels = c("0", "1"), labels = c("Incorrect", "Correct"), ordered = TRUE)))
# head(final_data[diet_col_names])

# Select the columns and convert to Likert data using the 'Likert' package
Q5_diet_cols <- final_data[diet_col_names]
Q5_diet_cols$SurveyType <- final_data$SurveyType

# GGplot example
Q5_diet_cols %>%
    gather(key = Diet, value = Answer, -SurveyType) %>%
    group_by(SurveyType, Diet, Answer) %>%
    summarise(count = length(Answer)) %>% 
    mutate(percent = count / sum(count) * 100) %>% 
    filter(., Answer == "Correct")

```


### Q6) What are white storks preferred feeding habitat? 

[multi-select] Shallow wetlands; Grassland; Farmland; Woodland; Urban; Don’t know 


```{r Q6 habitat questions, echo=FALSE, messages=FALSE}

# Create list of diet columns names for easier factorsation and labelling
habitat_cols <- c("Q6a_farmland_habitat", "Q6b_grassland_habitat","Q6c_wetlands_habitat","Q6d_woodland_habitat",                                                              "Q6e_urban_habitat","Q6f_Don.tKnow_habitat")
# Use mutate_at to set: if "don't know" = 1 then all other columns must = 0
# Then transform 0 and 1 to incorrect and correct
final_data <- final_data %>%
  mutate_at(.vars = c("Q6a_farmland_habitat", "Q6b_grassland_habitat","Q6c_wetlands_habitat",
                      "Q6d_woodland_habitat","Q6e_urban_habitat"), ~ ifelse(Q6f_Don.tKnow_habitat == 1, 0, .)) %>% 
  mutate_at(habitat_cols, funs(factor(.,
                       levels = c("0", "1"), labels = c("No", "Yes"), ordered = TRUE)))

# Select the columns and convert to Likert data using the 'Likert' package
Q6_habitat_cols <- final_data[habitat_cols]
Q6_habitat_cols$SurveyType <- final_data$SurveyType

# GGplot example
Q6_habitat_cols %>%
    gather(key = Habitat, value = Answer, -SurveyType) %>%
    group_by(SurveyType, Habitat, Answer) %>%
    summarise(count = length(Answer)) %>% 
    mutate(percent = count / sum(count) * 100) %>% 
    filter(., Answer == "Yes")

```


### Q7) Where do white storks typically nest?  

[multi-select] Trees; Roofs of buildings; Chimneys; Telegraph poles; Ground; Don’t know 



```{r Q7 nesting questions, echo=FALSE, messages=FALSE}
# head(final_data$Q7a_chimneys_nesting)
# Create list of diet columns names for easier factorsation and labelling
nest_cols <- c("Q7a_chimneys_nesting","Q7b_ground_nesting","Q7c_roofs_nesting",
                  "Q7d_telegraphpoles_nesting","Q7e_trees_nesting","Q7f_Don.tKnow_nesting")
# Use mutate_at to set: if "don't know" = 1 then all other columns must = 0
# Then transform 0 and 1 to incorrect and correct
final_data <- final_data %>%
  mutate_at(.vars = c("Q7a_chimneys_nesting","Q7b_ground_nesting","Q7c_roofs_nesting",
                  "Q7d_telegraphpoles_nesting","Q7e_trees_nesting"), ~ ifelse(Q7f_Don.tKnow_nesting == 1, 0, .)) %>% 
  mutate_at(nest_cols, funs(factor(.,
                       levels = c("0", "1"), labels = c("No", "Yes"), ordered = TRUE)))
# str(final_data[nest_cols])
# Select the columns and convert to Likert data using the 'Likert' package
Q7_nesting_cols <- final_data[nest_cols]
Q7_nesting_cols$SurveyType <- final_data$SurveyType

# GGplot example
Q7_nesting_cols %>%
    gather(key = Nest, value = Answer, -SurveyType) %>%
    group_by(SurveyType, Nest, Answer) %>%
    summarise(count = length(Answer)) %>% 
    mutate(percent = count / sum(count) * 100) %>% 
    filter(., Answer == "Yes")


```

## If/where seen a white stork
### Q8) Before taking this survey, had you ever seen a white stork? 

[multi-select] Yes, in the wild; Yes, in captivity; Yes, in pictures/videos; No; Not sure 



```{r Awareness and knowledge table, echo=FALSE, messages=FALSE, warning=FALSE}

### Q8) Before taking this survey, had you ever seen a white stork
Q8_seen_colnames$SurveyType <- final_data$SurveyType
Q8_seen_colnames$UniqueID_all <- final_data$UniqueID_all
head(Q8_seen_colnames)
# Calculate sample sizes and %
Q8_seen_colnames %>%
  tidyr::gather("Q8_option", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Q8_option, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) %>% 
  filter(., Answer == "1")

### Q8a) [if selected “Yes, in the wild”] Where did you see the white stork(s)?  
# Calculate sample sizes and %
final_data %>%
  dplyr::select(SurveyType, Q8.WhereSeen) %>% 
  dplyr::group_by(SurveyType, Q8.WhereSeen) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 


```



### Q9) Before taking this survey, had you ever heard of the White Stork Project and its efforts to reintroduce white storks to southern England? 

[options] Yes, No, Not sure 

```{r Q9 heard of ws, echo=FALSE, messages=FALSE, warning=FALSE}

### Q9) Before taking this survey, had you ever heard of the White Stork Project
# and its efforts to reintroduce white storks to southern England

# Calculate sample sizes and %
final_data %>%
  dplyr::group_by(SurveyType, Q9_heard) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100))

```


## Q10) How much do you feel you know about the white stork reintroduction currently taking place in southern England?  

Nothing; I have heard something but don’t know much; I know something about it; I know a lot about it; I am involved in the effort 


```{r Q10 communication options, echo=FALSE, messages=FALSE, warning=FALSE}

### Q10) How much do you feel you know about the white stork
# reintroduction currently taking place in southern England? 
# head(final_data$Q10_project_knowledge)

# Calculate sample sizes and %
final_data %>%
  dplyr::group_by(SurveyType, Q10_project_knowledge) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100))

```

### Q10a) [if selected any option apart from “Nothing”] Where have you heard about the white stork reintroduction project? 

[multi-select] White Stork Project website; Social media; TV/Radio; Newspaper; Email; Magazine; Leaflet; Talk by a project spokesperson; Visiting Knepp Estate; Word of mouth; Other 


```{r Q10a current comms, echo=FALSE, messages=FALSE, warning=FALSE}

# Source of information (current and preferred)
Q10_cursource_colnames <- dplyr::select(final_data, starts_with("Q10a"))

# 10a) [if selected any option apart from “Nothing”] 
# Where have you heard about the white stork reintroduction project? 
Q10_cursource_colnames$SurveyType <- final_data$SurveyType
Q10_cursource_colnames$UniqueID_all <- final_data$UniqueID_all

# Calculate sample sizes and %
Q10_cursource_colnames %>%
  tidyr::gather("Q10_cursource", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Q10_cursource, Answer) %>%                        
  na.omit %>% # Apply na.omit
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) %>% 
  filter(., Answer == "1")


```

### Q10b) How would you like information about the ongoing reintroduction to be communicated to you? 

[multi-select] White Stork Project website; Social media; TV/Radio; Newspaper; Email; Magazine; Leaflet; Talk by a project spokesperson; Not interested; Other 


```{r Q10b preferred comms, echo=FALSE, messages=FALSE, warning=FALSE}

# Source of information (preferred)
Q10_prefsource_colnames <- dplyr::select(final_data, starts_with("Q10b"))

# 10b) How would you like information about the ongoing
# reintroduction to be communicated to you?
Q10_prefsource_colnames$SurveyType <- final_data$SurveyType
Q10_prefsource_colnames$UniqueID_all <- final_data$UniqueID_all

# Calculate sample sizes and %
Q10_prefsource_colnames %>%
  tidyr::gather("Q10_prefsource", "Answer", -SurveyType, -UniqueID_all) %>% 
  dplyr::group_by(SurveyType, Q10_prefsource, Answer) %>% 
  na.omit %>% # Apply na.omit
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) %>% 
  filter(., Answer == "1")

        
```

### Q12-14) How much do you agree or disagree with the following statements? 

* White storks symbolise the beauty of nature.  
* White storks play an important role in their environment.  
* Reintroduced white storks may have a negative impact on my life.  
* I do not want white storks living near me.  
* White storks in England could benefit the tourism industry where they’re found. 
* I would find it exciting to see white storks in the wild in England.  
* White storks symbolise hope, rebirth and new life.  
* Money spent reintroducing white storks would be better spent elsewhere.  
* White storks might be detrimental to local wildlife.  
* There is no need to reintroduce the white stork to England as it is common throughout mainland Europe 
* I think white storks are useless birds. 
* White storks are part of our cultural and natural heritage  
* The reintroduced white stork can help people (re)connect with the natural world.  
* The countryside will be worse off with white storks around. 
* Overall, I support efforts that aim to reintroduce the UK’s lost species and restore its natural systems.  


```{r Q12-14 attitude likert, echo=FALSE, messages=FALSE, warning=FALSE}

# Q12-14 Attitude to white storks columns (Likert style data)
all_attitude_colnames <- dplyr::select(final_data, starts_with("Q13"),
                             starts_with("Q13"), starts_with("Q14"), -ends_with('score'))

# Create as new dataframe
likert_attitudes <- as.data.frame(all_attitude_colnames)
# Keep first 6 characters of columns names
names(likert_attitudes) <- substring(names(likert_attitudes), 7)
# Convert 'Don't know' to NA, then drop
likert_attitudes[ likert_attitudes == "Don't know" ] <- NA
likert_attitudes <- droplevels(likert_attitudes)
likert_attitudes$SurveyType <- final_data$SurveyType

# Create likert object and plot
likert_att <- likert(items=likert_attitudes[,1:10], grouping=likert_attitudes[,11])
# Set likert levels
likert_levels <- c("Group","Item","Strongly agree", "Agree", "Neutral",
                  "Disagree", "Strongly disagree")
likert_att$results <- likert_att$results[, likert_levels]
plot(likert_att, type="bar", text.size = 4,
     low.color = "#006a4e", high.color = "#f42a41", neutral.color = "#dedcdd")


# How much do you agree or disagree with the following statements 
all_attitude_colnames$SurveyType <- final_data$SurveyType
all_attitude_colnames$UniqueID_all <- final_data$UniqueID_all

# Calculate sample sizes and %
all_attitude_colnames %>%
  tidyr::gather("Attitude_questions", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Attitude_questions, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 


```


### Q17) Which (if any) methods of white stork project management would you support?  

[multi-select] Monitoring nests; Providing places for storks to nest; Discouraging nest building; Nest removal; Tracking movements of individual storks;Public engagement and outreach; Providing supplementary food; Compensation for damage caused by stork activity; Population management by moving storks to other locations; Population management by culling; No management will be necessary; Don't know; Other 

```{r Q17 management options, echo=FALSE, messages=FALSE, warning=FALSE}


Q17_management_colnames <- dplyr::select(final_data, starts_with("Q17"),
                                         -ends_with('open'))
# Inspect data and create new df
head(Q17_management_colnames)
Q17_management <-  as.data.frame(Q17_management_colnames)
# Add Survey type as colour/fill
Q17_management$SurveyType <- final_data$SurveyType
# Calculate sample sizes and %
Q17_management_summary <- Q17_management %>%
  tidyr::gather("Management_options", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Management_options, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100))%>% 
  filter(., Answer == "1")
Q17_management_summary

# Rename columns for pretty plot
Q17_management_summary$Management_options <- mapvalues(Q17_management_summary$Management_options,
          from = c("Q17.1_Nest_monitoring","Q17.2_Nesting_platforms", "Q17.3_Discouragenestbuilding",
                   "Q17.4_Nest_removal","Q17.5_Tracking","Q17.6_Public_engagement",
                   "Q17.7_Supplementary_food",
                   "Q17.8_compensation_storkdamage","Q17.9_Stork_relocation","Q17.10_Culling",
                   "Q17_11.management.not.needed","Q17.12_Don.tknow","Q17.13_other"),
          to = c("Nest monitoring","Nesting platform", "Discourage nests",
                   "Nest removal","Tracking","Public engagement","Supplementary food",
                   "Damage compensation","Stork relocation","Culling",
                 "Not needed","Don't know", "Other"))
# Plot the data
ggplot(Q17_management_summary, 
  aes(x = reorder(Management_options, Percent), y = Percent, fill = SurveyType)) +
    geom_bar(position="dodge", stat="identity") +
    labs(x = "Management options", y="Percentage of responses", fill = "Survey type") +
    geom_text(aes(Management_options, Percent, label = sprintf("%2.1f", Percent)), 
            position = position_dodge(width = 1)) + 
  scale_fill_manual(values = c("Proactive" = "#9CC3D5FF",
                               "NatRep" = "#ADEFD1FF")) +
  theme_minimal( base_size = 12) + 
  coord_flip()
```



### Q18) In an average week, how many days do you spend more than 1 hour outside in green and natural spaces?  

[options] None; 1-2 days; 3-4 days; 5-6 days; Every day - 7 days 



```{r Q18 experience, echo=FALSE, messages=FALSE, warning=FALSE}

Q18_exp_colnames <- dplyr::select(final_data, starts_with("Q18_"), -ends_with('open'))

# Q18) In an average week, how many days do you spend more than 1 hour outside in green and natural spaces?  
Q18_exp <- as.data.frame(Q18_exp_colnames)
Q18_exp <- rename(Q18_exp, "Frequency of nature experience" = Q18_exp_nature)
Q18_exp$SurveyType <- final_data$SurveyType

# # Create likert object and plot
# likert_exp <- likert(items=Q18_exp[,1], grouping=Q18_exp[,2])

# Calculate sample sizes and %
Q18_exp %>%
  tidyr::gather("Frequency", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Frequency, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100))


```


### Q18a) Which of these recreation activities do you do while you are outside in green and natural spaces?  

[multi-select] Walking (with dog); Walking (without dog); Running/cycling; Golf; Picnic; Horse riding; Bird/wildlife watching; Photography; Camping; Fishing; Shooting/hunting; Water sports/swimming; Gardening; I don’t spend my free time in green and natural spaces; Other 


```{r Q18 activities, echo=FALSE, messages=FALSE, warning=FALSE}

# Q18a) Which of these recreation activities do you do while you are outside in green and natural spaces?  

Q18_activity_cols <- dplyr::select(final_data, starts_with("Q18a."),
                                  -ends_with('open')) # Nature-based activities
# Inspect data and create new df
head(Q18_activity_cols)
Q18_activity <-  as.data.frame(Q18_activity_cols)
# Add Survey type as colour/fill
Q18_activity$SurveyType <- final_data$SurveyType

# Calculate sample sizes and %
Q18_activity_summary <- Q18_activity %>%
  tidyr::gather("Activities", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, Activities, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100))%>% 
  filter(., Answer == "1")
# Rename clumns
Q18_activity_summary$Activities <- mapvalues(Q18_activity_summary$Activities,
          from = c( "Q18a.bird.wildlife.watching","Q18a.camping",
                    "Q18a.don.t.spend.free.time.in.green.natural.spaces", "Q18a.fishing",                     
                    "Q18a.gardening","Q18a.golf", "Q18a.horse.riding","Q18a.photography",
                    "Q18a.picnic","Q18a.shooting.hunting","Q18a.water.sports.swimming"),
          to = c("Wildlife watching","Camping","I don't", "Fishing",                     
                    "Gardening","Golf", "Horse riding","Photography",
                    "Picnic","Shooting/hunting","Water sports/swimming"))
Q18_activity_summary

 # Plot the data
ggplot(Q18_activity_summary, 
  aes(x = reorder(Activities, Percent), y = Percent, fill = SurveyType)) +
    geom_bar(position="dodge", stat="identity") +
    labs(x = "Activities", y="Percentage of responses", fill = "Survey type") +
    geom_text(aes(Activities, Percent, label = sprintf("%2.1f", Percent)), 
            position = position_dodge(width = 1)) + 
  scale_fill_manual(values = c("Proactive" = "#9CC3D5FF",
                               "NatRep" = "#ADEFD1FF")) +
  theme_minimal( base_size = 12) + 
  coord_flip()

```


### Q19) How much do you agree or disagree with the following statements? 

* I find being in nature really amazing	 
* Spending time in nature is very important to me 
* Being in nature makes me very happy
* I always find beauty in nature
* I always treat nature with respect
* I feel part of nature 

[options] Completely disagree = 1, Strongly disagree = 2, Disagree = 3, Neither agree or disagree = 4, Agree = 5, Strongly agree = 6, Completely agree = 7 




```{r Q19 NCI, echo=FALSE, messages=FALSE, warning=FALSE}

# Q19) How much do you agree or disagree with the following statements?
Q19_NCI_colnames <- dplyr::select(final_data, starts_with("Q19"),
                                  -ends_with('score')) 
# Create as new dataframe
likert_NCI <- as.data.frame(Q19_NCI_colnames)
# Keep first 6 characters of columns names
# names(likert_NCI) <- substring(names(likert_NCI), 7)
levels(likert_NCI$Q19.1..I.find.being.in.nature.really.amazing)
# Convert 'Don't know' to NA, then drop
likert_NCI[ likert_NCI == "Don't know" ] <- NA
likert_NCI <- droplevels(likert_NCI)
likert_NCI$SurveyType <- final_data$SurveyType

# Create likert object and plot
likert_nci <- likert(items=likert_NCI[,1:6], grouping=likert_NCI[,7])
# Set likert levels
likert_nci_levels <- c("Group","Item","Completely agree","Strongly agree", "Agree",
                   "Neither agree or disagree","Disagree",
                   "Strongly disagree","Completely disagree")
likert_nci$results <- likert_nci$results[, likert_nci_levels]
plot(likert_nci,
     type="bar", text.size = 4)

# How much do you agree or disagree with the following statements 
Q19_NCI_colnames$SurveyType <- final_data$SurveyType
Q19_NCI_colnames$UniqueID_all <- final_data$UniqueID_all
head(Q19_NCI_colnames)
# Calculate sample sizes and %
Q19_NCI_colnames %>%
  tidyr::gather("NCI_questions", "Answer", -SurveyType) %>% 
  dplyr::group_by(SurveyType, NCI_questions, Answer) %>% 
  summarise(n = n()) %>%
  mutate(Percent = (n / sum(n)*100)) 
```


### Q20) In relation to the UK, how concerned are you about: 

* Damage to the natural environment 
* The consequences of a loss of variety of wildlife 

[options] Not at all concerned = 1, Not very concerned = 2, Neither concerned or unconcerned = 3, Concerned = 4, Extremely concerned = 5 




```{r Q20 envconcern, echo=FALSE, messages=FALSE, warning=FALSE}
# Q20) In relation to the UK, how concerned are you about:
Q20_envconcern_colnames <- dplyr::select(final_data, starts_with("Q20"),
                                         -ends_with('score')) # Q21 total score = Env.concern score
# Create as new dataframe
likert_env <- as.data.frame(Q20_envconcern_colnames)
# Keep first 6 characters of columns names
# names(likert_NCI) <- substring(names(likert_NCI), 7)
levels(likert_env$Q20.2..The.consequences.of.a.loss.of.variety.of.wildlife)
likert_env$SurveyType <- final_data$SurveyType

# Create likert object and plot
likert_envconcern <- likert(items=likert_env[,1:2], grouping=likert_env[,3])
# Set likert levels
likert_envconcern_levels <- c("Group","Item", "Extremely concerned","Concerned",
                              "Neither concerned or unconcerned", "Not very concerned",
                              "Not at all concerned" )
likert_envconcern$results <- likert_envconcern$results[, likert_envconcern_levels]
plot(likert_envconcern,
     type="bar", text.size = 4)

```


### Q21) How often do you do the actions below when you have the opportunity? 

* When I see litter, I pick it up.
* I vote for nature or wildlife conservation friendly legislation in local or national referendums/votes/etc.      
* I get in touch with local authorities on nature conservation issues.
* I vote for parties/ candidates with strong pro-nature conservation policies in elections. 

[Options] Never = 1, Rarely = 2, Occasionally = 3, Sometimes = 4, Frequently = 5, Very frequently = 6, Always = 7 


```{r Q21_ProCoBS, echo=FALSE, messages=FALSE, warning=FALSE}
# Q21) How often do you do the actions below when you have the opportunity? 
Q21_ProCoBS_colnames <- dplyr::select(final_data, starts_with("Q21"),
                                      -ends_with('score')) # Q21 total score = ProCoBS
# Create as new dataframe
likert_pro <- as.data.frame(Q21_ProCoBS_colnames)
# Keep first 6 characters of columns names
# names(likert_NCI) <- substring(names(likert_NCI), 7)
levels(likert_pro$Q21.1..When.I.see.litter..I.pick.it.up)
likert_pro$SurveyType <- final_data$SurveyType

# Create likert object and plot
likert_procobs <- likert(items=likert_pro[,1:4], grouping=likert_pro[,5])
# Set likert levels
likert_pro_levels <- c("Group","Item","Always","Very Frequently",
                              "Frequently","Sometimes","Occasionally","Rarely","Never")
likert_procobs$results <- likert_procobs$results[, likert_pro_levels]
plot(likert_procobs,
     type="bar", text.size = 4)

```


### Q23) Thinking about your daily life, how much do you agree or disagree with the following statements?  

* I pay attention to birds wherever I go.
* I can identify common birds in my area.
* Seeing a new bird fills me with excitement. 	 
* I am not interested in birds. 

[Options] Strongly Disagree = 1, Disagree = 2, Neutral = 3, Agree = 4, Strongly Agree = 5. [†reverse scored] 


```{r Q23 Bird interest score, echo=FALSE, messages=FALSE, warning=FALSE}
# Q23) Thinking about your daily life, how much do you agree or disagree with the following statements? 
Q23_BIS_colnames <- dplyr::select(final_data, starts_with("Q23"),
                                  -ends_with('score')) # Q23 total score = BirdInterestScore
# Create as new dataframe
likert_BIS <- as.data.frame(Q23_BIS_colnames)
# Keep first 6 characters of columns names
# names(likert_NCI) <- substring(names(likert_NCI), 7)
likert_BIS$SurveyType <- final_data$SurveyType
# Create likert object and plot
likert_bis <- likert(items=likert_BIS[,1:4], grouping=likert_BIS[,5])
likert_levels <- c("Group","Item","Strongly agree", "Agree", "Neither agree or disagree",
                  "Disagree", "Strongly disagree")
# Set likert levels
likert_bis$results <- likert_bis$results[, likert_levels]
plot(likert_bis,
     type="bar", text.size = 4)

```